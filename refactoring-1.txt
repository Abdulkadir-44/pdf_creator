ğŸš€ Proje Raporu: "Soru Otomasyon Sistemi" Refactoring Ã–zeti
ğŸ¯ AmaÃ§: 1500+ satÄ±rlÄ±k, iÃ§inde kaybolduÄŸumuz soru_parametresi_sec_ui.py "God Class" (Her Åeyi Yapan SÄ±nÄ±f) yapÄ±sÄ±nÄ± parÃ§alamak. SorumluluklarÄ± ayÄ±rarak (Separation of Concerns) projenin bakÄ±mÄ±nÄ± kolaylaÅŸtÄ±rmak ve performans iyileÅŸtirmelerine zemin hazÄ±rlamak.

Yeni Mimari: ArtÄ±k "YÃ¶netici", "Beyin" ve "Ameleler" (Ä°ÅŸÃ§iler) olarak Ã§alÄ±ÅŸan net bir hiyerarÅŸimiz var.

ğŸ“Š Rollerin DaÄŸÄ±lÄ±mÄ±: Hangi Dosya Ne Ä°ÅŸe YarÄ±yor?
1. "YÃ¶netici" (Ana Controller)
Bu, projenin ana yÃ¶neticisidir. ArtÄ±k neredeyse hiÃ§ Ã§izim yapmaz veya nasÄ±l yapÄ±lacaÄŸÄ±nÄ± bilmez. Sadece "Beyin"e ve "Ameleler"e emir verir ve "state"i (durumu) tutar.

Dosya: ui/soru_parametresi_sec_ui.py

GÃ¶revi:

TÃ¼m diÄŸer sÄ±nÄ±flarÄ±n (Beyin, Ameleler) Ã¶rneklerini (instance) oluÅŸturur ve tutar (self.oturum_yoneticisi, self.parametre_formu vb.).

Hangi ekranÄ±n gÃ¶sterileceÄŸine karar verir (goster_parametre_formu ile gorsel_onizleme_alani_olustur arasÄ±nda geÃ§iÅŸ yapar).

Ameleler'den gelen sinyalleri (callback) dinler (Ã¶rn: KontrolPaneli'nden "Sil" sinyali gelince).

Gelen sinyalleri "Beyin"e paslar (self.oturum_yoneticisi.gorseli_kaldir_new(index) Ã§aÄŸrÄ±sÄ± gibi).

TÃ¼m ana "state"i (durum) Ã¼zerinde tutar: self.sayfa_haritasi, self.secilen_gorseller, self.current_page vb.

2. "Beyin" (Ä°ÅŸ MantÄ±ÄŸÄ± / Business Logic)
Bu, projenin gÃ¶rsel olmayan, saf iÅŸ mantÄ±ÄŸÄ±dÄ±r. TÃ¼m hesaplamalar ve "state" (durum) deÄŸiÅŸiklikleri burada yapÄ±lÄ±r.

Dosya: logic/oturum_yoneticisi.py

GÃ¶revi:

"YÃ¶netici"den (controller) gelen emirleri (gorseli_guncelle_new, pdf_olustur vb.) Ã§alÄ±ÅŸtÄ±rÄ±r.

TÃ¼m "havuz" mantÄ±ÄŸÄ±nÄ±, rastgele gÃ¶rsel seÃ§imini (secili_gorselleri_al) ve dosya kontrollerini yapar.

PDFCreator'Ã¼ Ã§aÄŸÄ±rarak sayfa_haritasi'nÄ± planlar (_replan_and_refresh_ui).

"YÃ¶netici"nin Ã¼zerindeki self.secilen_gorseller gibi "state"leri (durumlarÄ±) gÃ¼nceller.

Ä°ÅŸ bittiÄŸinde, "YÃ¶netici"nin display_images_new gibi UI (arayÃ¼z) fonksiyonlarÄ±nÄ± tetikler.

3. "Ameleler" (GÃ¶rsel BileÅŸenler / UI Workers)
Bunlar, "YÃ¶netici"nin emirlerine gÃ¶re ekrana bir ÅŸeyler Ã§izen "aptal" bileÅŸenlerdir. Kendi baÅŸlarÄ±na karar vermezler, sadece sinyal gÃ¶nderirler.

Dosya: ui/parametre_sayfasi/parametre_secim_formu.py

GÃ¶revi: Ekran 1'i (Soru Tipi, Zorluk, Konu-Adet formu) Ã§izer. "Devam Et" butonuna basÄ±ldÄ±ÄŸÄ±nda "YÃ¶netici"ye _form_onaylandi_callback sinyalini gÃ¶nderir.

Dosya: ui/parametre_sayfasi/sayfa_basligi.py

GÃ¶revi: En Ã¼stteki BaÅŸlÄ±k (Header) Ã§ubuÄŸunu Ã§izer ("Ana MenÃ¼", "Konu SeÃ§imi" butonlarÄ±). "Ana MenÃ¼"ye basÄ±ldÄ±ÄŸÄ±nda "YÃ¶netici"ye ana_menuye_don sinyalini gÃ¶nderir.

Dosya: ui/parametre_sayfasi/onizleme_ekrani.py

GÃ¶revi: Ekran 2'nin Ä°skeletini Ã§izer (Sol boÅŸ panel pdf_container ve SaÄŸ boÅŸ panel controls_container). Ä°Ã§iyle ilgilenmez.

Dosya: ui/parametre_sayfasi/kontrol_paneli.py

GÃ¶revi: SaÄŸ Panelin Ä°Ã§eriÄŸini Ã§izer (BaÅŸlÄ±k kutusu, "Soru 1", "Soru 2" listesi, "Sil" / "GÃ¼ncelle" / "PDF OluÅŸtur" butonlarÄ±). "Sil"e basÄ±ldÄ±ÄŸÄ±nda "YÃ¶netici"ye on_kaldir sinyalini gÃ¶nderir.

4. "Uzman Ameleler" (YardÄ±mcÄ±lar / Utilities)
Bunlar, belirli bir uzmanlÄ±k alanÄ±nda hizmet veren "amelelerdir".

Dosya: logic/onizleme_cizici.py

GÃ¶revi: "Ã‡izim UzmanÄ±". "YÃ¶netici"den (Controller) verileri (sayfa_haritasi, baÅŸlÄ±k metni vb.) alÄ±r, tÃ¼m PIL (Pillow) Ã§izim iÅŸlerini yapar ve geriye hazÄ±r bir ImageTk.PhotoImage nesnesi (resim) dÃ¶ndÃ¼rÃ¼r. templates klasÃ¶rÃ¼nÃ¼n yolunu kendi kendine bulur.

Dosya: ui/dialog_yoneticisi.py

GÃ¶revi: "Pop-up UzmanÄ±". "YÃ¶netici"den veya "Beyin"den gelen show_error, show_notification gibi komutlarla ekrana hata/bilgi pencereleri Ã§Ä±karÄ±r.

ğŸ› Sorun Ã‡Ä±karsa Nereye BakmalÄ±? (Hata AyÄ±klama Rehberi)
"Devam Et" butonuna bastÄ±m, Ekran 2 gelmedi, hata verdi:

logic/oturum_yoneticisi.py -> _proceed_to_preview fonksiyonuna bak. Muhtemelen planla_test_duzeni (PDFCreator'dan gelen) veya secili_gorselleri_al kÄ±smÄ±nda sorun vardÄ±r.

Ekran 2'de "Sil" veya "GÃ¼ncelle" butonu Ã§alÄ±ÅŸmÄ±yor veya yanlÄ±ÅŸ Ã§alÄ±ÅŸÄ±yor:

logic/oturum_yoneticisi.py -> gorseli_kaldir_new veya gorseli_guncelle_new fonksiyonlarÄ±na bak. TÃ¼m havuz mantÄ±ÄŸÄ± ve liste gÃ¼ncellemeleri buradadÄ±r.

Ekran 2'deyim ama Sol taraftaki Ã–nizleme Resmi bozuk, eksik veya hatalÄ± gÃ¶rÃ¼nÃ¼yor:

logic/onizleme_cizici.py -> _create_test_preview_BestFit veya _draw_title_on_image fonksiyonlarÄ±na bak. TÃ¼m PIL (Ã§izim) mantÄ±ÄŸÄ± buradadÄ±r.

Ekran 2'de SaÄŸ Panel (Soru Listesi) hiÃ§ gelmedi veya butonlar eksik:

ui/parametre_sayfasi/kontrol_paneli.py -> __init__ metoduna bak. Ã‡izim iÅŸi buradadÄ±r.

EÄŸer hata veriyorsa: ui/soru_parametresi_sec_ui.py -> display_images_new fonksiyonundaki callbacks sÃ¶zlÃ¼ÄŸÃ¼ne bak. Muhtemelen "Beyin"e pasladÄ±ÄŸÄ±n bir fonksiyonun adÄ±nÄ± (gorseli_guncelle_new gibi) ana dosyadan silmiÅŸsindir (az Ã¶nceki hata gibi).

"Ana MenÃ¼" veya "Konu SeÃ§imi" butonlarÄ± Ã§alÄ±ÅŸmÄ±yor:

ui/parametre_sayfasi/sayfa_basligi.py -> command'larÄ±n doÄŸru callback'i Ã§aÄŸÄ±rdÄ±ÄŸÄ±ndan emin ol.

ui/soru_parametresi_sec_ui.py -> ana_menuye_don veya konu_baslik_sayfasina_don fonksiyonlarÄ±nÄ±n iÃ§ine bak.